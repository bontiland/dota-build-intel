<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dota Build Intel</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: #0a0c10; color: #e2e8f0; font-family: 'Segoe UI', system-ui, sans-serif; }
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-thumb { background: rgba(245,158,11,0.4); border-radius: 2px; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .hrow { transition: background 0.15s; cursor: pointer; border: none; width: 100%; text-align: left; }
    .hrow:hover { background: rgba(245,158,11,0.1); }
    .tab-btn { background: transparent; border: none; border-bottom: 2px solid transparent; color: #6b7280; padding: 10px 18px; cursor: pointer; font-size: 13px; font-weight: 600; font-family: inherit; transition: all 0.2s; margin-bottom: -1px; }
    .tab-btn.active { color: #f59e0b; border-bottom-color: #f59e0b; }
    input { outline: none; }
    input:focus { border-color: rgba(245,158,11,0.7) !important; }
  </style>
</head>
<body>
<div id="app"></div>

<script>
const HEROES = [
  {id:1,name:"antimage",full:"Anti-Mage",roles:["Carry","Escape"]},
  {id:2,name:"axe",full:"Axe",roles:["Initiator","Durable","Disabler"]},
  {id:3,name:"bane",full:"Bane",roles:["Support","Disabler","Nuker"]},
  {id:4,name:"bloodseeker",full:"Bloodseeker",roles:["Carry","Nuker"]},
  {id:5,name:"crystal_maiden",full:"Crystal Maiden",roles:["Support","Disabler"]},
  {id:6,name:"drow_ranger",full:"Drow Ranger",roles:["Carry"]},
  {id:7,name:"earthshaker",full:"Earthshaker",roles:["Initiator","Disabler"]},
  {id:8,name:"juggernaut",full:"Juggernaut",roles:["Carry","Pusher"]},
  {id:9,name:"mirana",full:"Mirana",roles:["Carry","Support","Escape"]},
  {id:10,name:"morphling",full:"Morphling",roles:["Carry","Escape"]},
  {id:11,name:"nevermore",full:"Shadow Fiend",roles:["Carry","Nuker"]},
  {id:12,name:"phantom_lancer",full:"Phantom Lancer",roles:["Carry","Escape"]},
  {id:13,name:"puck",full:"Puck",roles:["Escape","Nuker","Disabler"]},
  {id:14,name:"pudge",full:"Pudge",roles:["Disabler","Initiator","Durable"]},
  {id:15,name:"razor",full:"Razor",roles:["Carry","Durable"]},
  {id:16,name:"sand_king",full:"Sand King",roles:["Initiator","Disabler"]},
  {id:17,name:"storm_spirit",full:"Storm Spirit",roles:["Carry","Escape","Nuker"]},
  {id:18,name:"sven",full:"Sven",roles:["Carry","Initiator","Durable"]},
  {id:19,name:"tiny",full:"Tiny",roles:["Carry","Nuker","Initiator"]},
  {id:20,name:"vengefulspirit",full:"Vengeful Spirit",roles:["Support","Disabler"]},
  {id:21,name:"windrunner",full:"Windranger",roles:["Support","Carry","Escape"]},
  {id:22,name:"zuus",full:"Zeus",roles:["Nuker"]},
  {id:23,name:"kunkka",full:"Kunkka",roles:["Carry","Support","Initiator"]},
  {id:25,name:"lina",full:"Lina",roles:["Support","Carry","Nuker"]},
  {id:26,name:"lion",full:"Lion",roles:["Support","Disabler","Nuker"]},
  {id:27,name:"shadow_shaman",full:"Shadow Shaman",roles:["Support","Disabler","Pusher"]},
  {id:28,name:"slardar",full:"Slardar",roles:["Carry","Initiator","Disabler"]},
  {id:29,name:"tidehunter",full:"Tidehunter",roles:["Initiator","Disabler","Durable"]},
  {id:30,name:"witch_doctor",full:"Witch Doctor",roles:["Support","Disabler","Nuker"]},
  {id:31,name:"lich",full:"Lich",roles:["Support","Nuker","Disabler"]},
  {id:32,name:"riki",full:"Riki",roles:["Carry","Escape","Disabler"]},
  {id:33,name:"enigma",full:"Enigma",roles:["Initiator","Disabler","Jungler"]},
  {id:34,name:"tinker",full:"Tinker",roles:["Nuker","Pusher"]},
  {id:35,name:"sniper",full:"Sniper",roles:["Carry","Nuker"]},
  {id:36,name:"necrolyte",full:"Necrophos",roles:["Carry","Support","Nuker"]},
  {id:37,name:"warlock",full:"Warlock",roles:["Support","Initiator","Nuker"]},
  {id:38,name:"beastmaster",full:"Beastmaster",roles:["Initiator","Jungler","Durable"]},
  {id:39,name:"queenofpain",full:"Queen of Pain",roles:["Carry","Escape","Nuker"]},
  {id:40,name:"venomancer",full:"Venomancer",roles:["Carry","Support","Nuker"]},
  {id:41,name:"faceless_void",full:"Faceless Void",roles:["Carry","Initiator","Disabler"]},
  {id:42,name:"skeleton_king",full:"Wraith King",roles:["Carry","Initiator","Durable"]},
  {id:43,name:"death_prophet",full:"Death Prophet",roles:["Carry","Pusher","Nuker"]},
  {id:44,name:"phantom_assassin",full:"Phantom Assassin",roles:["Carry","Escape"]},
  {id:45,name:"pugna",full:"Pugna",roles:["Support","Nuker","Pusher"]},
  {id:46,name:"templar_assassin",full:"Templar Assassin",roles:["Carry","Escape","Nuker"]},
  {id:47,name:"viper",full:"Viper",roles:["Carry","Nuker","Durable"]},
  {id:48,name:"luna",full:"Luna",roles:["Carry","Pusher"]},
  {id:49,name:"dragon_knight",full:"Dragon Knight",roles:["Carry","Durable","Pusher"]},
  {id:50,name:"dazzle",full:"Dazzle",roles:["Support","Nuker","Disabler"]},
  {id:51,name:"rattletrap",full:"Clockwerk",roles:["Initiator","Durable","Disabler"]},
  {id:52,name:"leshrac",full:"Leshrac",roles:["Carry","Support","Nuker"]},
  {id:53,name:"furion",full:"Nature's Prophet",roles:["Carry","Pusher","Jungler"]},
  {id:54,name:"life_stealer",full:"Lifestealer",roles:["Carry","Durable","Jungler"]},
  {id:55,name:"dark_seer",full:"Dark Seer",roles:["Initiator","Disabler","Support"]},
  {id:56,name:"clinkz",full:"Clinkz",roles:["Carry","Escape","Nuker"]},
  {id:57,name:"omniknight",full:"Omniknight",roles:["Support","Durable"]},
  {id:58,name:"enchantress",full:"Enchantress",roles:["Support","Carry","Jungler"]},
  {id:59,name:"huskar",full:"Huskar",roles:["Carry","Durable","Initiator"]},
  {id:60,name:"night_stalker",full:"Night Stalker",roles:["Carry","Initiator","Durable"]},
  {id:61,name:"broodmother",full:"Broodmother",roles:["Carry","Pusher","Escape"]},
  {id:62,name:"bounty_hunter",full:"Bounty Hunter",roles:["Carry","Support","Escape"]},
  {id:63,name:"weaver",full:"Weaver",roles:["Carry","Escape","Nuker"]},
  {id:64,name:"jakiro",full:"Jakiro",roles:["Support","Nuker","Disabler"]},
  {id:65,name:"batrider",full:"Batrider",roles:["Initiator","Disabler","Nuker"]},
  {id:66,name:"chen",full:"Chen",roles:["Support","Jungler","Pusher"]},
  {id:67,name:"spectre",full:"Spectre",roles:["Carry","Durable"]},
  {id:68,name:"ancient_apparition",full:"Ancient Apparition",roles:["Support","Nuker","Disabler"]},
  {id:69,name:"doom_bringer",full:"Doom",roles:["Carry","Jungler","Disabler"]},
  {id:70,name:"ursa",full:"Ursa",roles:["Carry","Jungler","Initiator"]},
  {id:71,name:"spirit_breaker",full:"Spirit Breaker",roles:["Initiator","Carry","Durable"]},
  {id:72,name:"gyrocopter",full:"Gyrocopter",roles:["Carry","Nuker","Initiator"]},
  {id:73,name:"alchemist",full:"Alchemist",roles:["Carry","Durable","Jungler"]},
  {id:74,name:"invoker",full:"Invoker",roles:["Carry","Nuker","Disabler"]},
  {id:75,name:"silencer",full:"Silencer",roles:["Carry","Support","Disabler"]},
  {id:76,name:"obsidian_destroyer",full:"Outworld Destroyer",roles:["Carry","Nuker","Disabler"]},
  {id:77,name:"lycan",full:"Lycan",roles:["Carry","Pusher","Jungler"]},
  {id:78,name:"brewmaster",full:"Brewmaster",roles:["Initiator","Nuker","Durable"]},
  {id:79,name:"shadow_demon",full:"Shadow Demon",roles:["Support","Disabler","Nuker"]},
  {id:80,name:"lone_druid",full:"Lone Druid",roles:["Carry","Pusher","Jungler"]},
  {id:81,name:"chaos_knight",full:"Chaos Knight",roles:["Carry","Initiator","Durable"]},
  {id:82,name:"meepo",full:"Meepo",roles:["Carry","Jungler","Escape"]},
  {id:83,name:"treant",full:"Treant Protector",roles:["Support","Initiator","Durable"]},
  {id:84,name:"ogre_magi",full:"Ogre Magi",roles:["Support","Durable","Nuker"]},
  {id:85,name:"undying",full:"Undying",roles:["Support","Initiator","Durable"]},
  {id:86,name:"rubick",full:"Rubick",roles:["Support","Nuker","Disabler"]},
  {id:87,name:"disruptor",full:"Disruptor",roles:["Support","Nuker","Disabler"]},
  {id:88,name:"nyx_assassin",full:"Nyx Assassin",roles:["Support","Nuker","Disabler"]},
  {id:89,name:"naga_siren",full:"Naga Siren",roles:["Carry","Disabler","Pusher"]},
  {id:90,name:"keeper_of_the_light",full:"Keeper of the Light",roles:["Support","Nuker","Pusher"]},
  {id:91,name:"wisp",full:"Io",roles:["Support","Escape"]},
  {id:92,name:"visage",full:"Visage",roles:["Support","Carry","Nuker"]},
  {id:93,name:"slark",full:"Slark",roles:["Carry","Escape","Disabler"]},
  {id:94,name:"medusa",full:"Medusa",roles:["Carry","Durable"]},
  {id:95,name:"troll_warlord",full:"Troll Warlord",roles:["Carry","Disabler"]},
  {id:96,name:"centaur",full:"Centaur Warrunner",roles:["Initiator","Durable","Disabler"]},
  {id:97,name:"magnataur",full:"Magnus",roles:["Initiator","Disabler","Carry"]},
  {id:98,name:"shredder",full:"Timbersaw",roles:["Carry","Escape","Nuker"]},
  {id:99,name:"bristleback",full:"Bristleback",roles:["Carry","Durable","Nuker"]},
  {id:100,name:"tusk",full:"Tusk",roles:["Support","Initiator","Disabler"]},
  {id:101,name:"skywrath_mage",full:"Skywrath Mage",roles:["Support","Nuker","Disabler"]},
  {id:102,name:"abaddon",full:"Abaddon",roles:["Support","Carry","Durable"]},
  {id:103,name:"elder_titan",full:"Elder Titan",roles:["Support","Initiator","Disabler"]},
  {id:104,name:"legion_commander",full:"Legion Commander",roles:["Carry","Initiator","Durable"]},
  {id:105,name:"techies",full:"Techies",roles:["Support","Nuker","Disabler"]},
  {id:106,name:"ember_spirit",full:"Ember Spirit",roles:["Carry","Escape","Nuker"]},
  {id:107,name:"earth_spirit",full:"Earth Spirit",roles:["Initiator","Disabler","Nuker"]},
  {id:108,name:"abyssal_underlord",full:"Underlord",roles:["Initiator","Durable","Pusher"]},
  {id:109,name:"terrorblade",full:"Terrorblade",roles:["Carry","Pusher","Escape"]},
  {id:110,name:"phoenix",full:"Phoenix",roles:["Support","Initiator","Nuker"]},
  {id:111,name:"oracle",full:"Oracle",roles:["Support","Nuker","Disabler"]},
  {id:112,name:"over_mind",full:"Winter Wyvern",roles:["Support","Nuker","Disabler"]},
  {id:113,name:"arc_warden",full:"Arc Warden",roles:["Carry","Escape","Nuker"]},
  {id:114,name:"monkey_king",full:"Monkey King",roles:["Carry","Escape","Initiator"]},
  {id:119,name:"dark_willow",full:"Dark Willow",roles:["Support","Escape","Nuker"]},
  {id:120,name:"pangolier",full:"Pangolier",roles:["Initiator","Disabler","Escape"]},
  {id:121,name:"grimstroke",full:"Grimstroke",roles:["Support","Nuker","Disabler"]},
  {id:123,name:"hoodwink",full:"Hoodwink",roles:["Support","Carry","Escape"]},
  {id:126,name:"void_spirit",full:"Void Spirit",roles:["Carry","Escape","Nuker"]},
  {id:128,name:"snapfire",full:"Snapfire",roles:["Support","Disabler","Nuker"]},
  {id:129,name:"mars",full:"Mars",roles:["Carry","Initiator","Durable"]},
  {id:131,name:"ringmaster",full:"Ringmaster",roles:["Support","Disabler"]},
  {id:135,name:"dawnbreaker",full:"Dawnbreaker",roles:["Carry","Support","Initiator"]},
  {id:136,name:"marci",full:"Marci",roles:["Support","Carry","Initiator"]},
  {id:137,name:"primal_beast",full:"Primal Beast",roles:["Initiator","Durable","Nuker"]},
  {id:138,name:"muerta",full:"Muerta",roles:["Carry","Support","Disabler"]},
  {id:145,name:"kez",full:"Kez",roles:["Carry","Escape","Nuker"]},
].sort((a,b) => a.full.localeCompare(b.full));

const ROLES_COLOR = {Carry:"#f59e0b",Support:"#60a5fa",Nuker:"#f87171",Disabler:"#a78bfa",Jungler:"#34d399",Durable:"#fb923c",Escape:"#e879f9",Pusher:"#4ade80",Initiator:"#fbbf24"};
const HERO_IMG = n => `https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/heroes/${n}.png`;
const ITEM_IMG = n => `https://cdn.cloudflare.steamstatic.com/apps/dota2/images/dota_react/items/${n.replace('item_','')}.png`;

// ---- STATE ----
let state = {
  search: '',
  selected: null,
  loading: false,
  error: null,
  items: null,   // raw API response
  abilities: null,
  tab: 'items',
  apiDebug: null
};

function setState(patch) {
  Object.assign(state, patch);
  render();
}

// ---- API ----
async function loadHero(hero) {
  setState({selected: hero, loading: true, error: null, items: null, abilities: null, search: '', apiDebug: null});
  try {
    // Use OpenDota public API
    const [itemsRes, abilitiesRes] = await Promise.all([
      fetch(`https://api.opendota.com/api/heroes/${hero.id}/itemPopularity`),
      fetch(`https://api.opendota.com/api/heroes/${hero.id}/abilities`)
    ]);
    const items = await itemsRes.json();
    const abilities = await abilitiesRes.json();

    // Store raw for debug
    setState({
      loading: false,
      items,
      abilities,
      apiDebug: JSON.stringify(items).slice(0, 300)
    });
  } catch(e) {
    setState({loading: false, error: 'Error de conexi√≥n: ' + e.message});
  }
}

// ---- PARSE DATA ----
function getPhases(items) {
  if (!items || typeof items !== 'object') return [];
  const phases = [
    {key: 'start_game_items', label: 'INICIO', icon: 'üåÖ'},
    {key: 'early_game_items', label: 'EARLY', icon: '‚ö°'},
    {key: 'mid_game_items',   label: 'MID',   icon: '‚öîÔ∏è'},
    {key: 'late_game_items',  label: 'LATE',  icon: 'üëë'},
  ];
  return phases.map(p => {
    const raw = items[p.key];
    if (!raw || typeof raw !== 'object') return {...p, list: []};
    const list = Object.entries(raw)
      .filter(([, v]) => v && typeof v === 'object' && v.games > 0)
      .map(([name, v]) => ({name, wr: v.wins / v.games, games: v.games}))
      .sort((a,b) => b.wr - a.wr)
      .slice(0, 6);
    return {...p, list};
  });
}

function getAbilities(abilities) {
  if (!abilities || typeof abilities !== 'object') return [];
  return Object.entries(abilities)
    .filter(([, v]) => v && v.games > 0)
    .map(([name, v]) => ({name, wr: v.wins / v.games, games: v.games}))
    .sort((a,b) => b.wr - a.wr)
    .slice(0, 8);
}

// ---- RENDER ----
function wr(val) {
  const p = Math.round(val * 100);
  const c = p >= 55 ? '#4ade80' : p >= 50 ? '#fbbf24' : '#f87171';
  return `<span style="color:${c};font-weight:700;font-family:monospace;font-size:13px">${p}% WR</span>`;
}

function renderItemCard(item) {
  const name = item.name.replace('item_','').replace(/_/g,' ');
  const imgSrc = ITEM_IMG(item.name);
  return `
    <div style="flex:1 1 110px;padding:14px 10px;display:flex;flex-direction:column;align-items:center;gap:6px;border-right:1px solid rgba(255,255,255,0.04);text-align:center">
      <img src="${imgSrc}" style="width:72px;height:52px;object-fit:cover;border-radius:6px;border:1px solid rgba(255,255,255,0.15);background:#1a2030"
           onerror="this.style.display='none'" />
      <div style="font-size:11px;color:#9ca3af;text-transform:capitalize;max-width:100px;line-height:1.3">${name}</div>
      ${wr(item.wr)}
      <div style="font-size:10px;color:#374151;font-family:monospace">${item.games.toLocaleString()}p</div>
    </div>`;
}

function renderPhase(phase) {
  const hasData = phase.list.length > 0;
  return `
    <div style="background:rgba(255,255,255,0.025);border:1px solid rgba(255,255,255,0.07);border-radius:12px;overflow:hidden;margin-bottom:16px">
      <div style="padding:11px 16px;background:rgba(255,255,255,0.02);border-bottom:1px solid rgba(255,255,255,0.05);display:flex;align-items:center;justify-content:space-between">
        <span style="font-size:13px;font-weight:800;letter-spacing:1.5px;color:#f59e0b;text-transform:uppercase">${phase.icon} ${phase.label} GAME</span>
        ${!hasData ? '<span style="font-size:11px;color:#374151;font-style:italic">Sin datos de la API</span>' : ''}
      </div>
      ${hasData ? `<div style="display:flex;flex-wrap:wrap">${phase.list.map(renderItemCard).join('')}</div>` : ''}
    </div>`;
}

function renderAbilityRow(ab, i) {
  const p = Math.round(ab.wr * 100);
  const bar = p >= 55 ? '#4ade80' : p >= 50 ? '#fbbf24' : '#f87171';
  const name = ab.name.replace(/_/g,' ');
  return `
    <div style="background:rgba(255,255,255,0.025);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 16px;display:flex;align-items:center;gap:14px;margin-bottom:10px">
      <div style="font-size:12px;font-family:monospace;font-weight:800;min-width:26px;color:${i<3?'#f59e0b':'#374151'}">#${i+1}</div>
      <div style="flex:1;min-width:0">
        <div style="font-size:13px;font-weight:600;color:#d1d5db;text-transform:capitalize;margin-bottom:7px">${name}</div>
        <div style="height:5px;background:rgba(255,255,255,0.06);border-radius:3px;overflow:hidden">
          <div style="height:100%;width:${p}%;background:${bar};border-radius:3px"></div>
        </div>
      </div>
      <div style="text-align:right;min-width:80px">
        ${wr(ab.wr)}
        <div style="font-size:10px;color:#374151;font-family:monospace;margin-top:3px">${ab.games.toLocaleString()}p</div>
      </div>
    </div>`;
}

function render() {
  const {search, selected, loading, error, items, abilities, tab, apiDebug} = state;
  const filtered = HEROES.filter(h => h.full.toLowerCase().includes(search.toLowerCase()));
  const list = search ? filtered : HEROES;

  document.getElementById('app').innerHTML = `
  <div style="display:flex;flex-direction:column;min-height:100vh">

    <!-- HEADER -->
    <header style="display:flex;align-items:center;justify-content:space-between;padding:13px 24px;background:#0d1017;border-bottom:1px solid rgba(245,158,11,0.2);flex-shrink:0;position:sticky;top:0;z-index:100">
      <div style="display:flex;align-items:center;gap:10px">
        <span style="color:#f59e0b;font-size:18px">‚óÜ</span>
        <span style="font-size:16px;font-weight:900;letter-spacing:3px;color:#fff">DOTA BUILD INTEL</span>
      </div>
      <span style="font-size:11px;color:#374151">${HEROES.length} h√©roes ¬∑ OpenDota API</span>
    </header>

    <div style="display:flex;flex:1;height:calc(100vh - 50px);overflow:hidden">

      <!-- SIDEBAR -->
      <aside style="width:250px;background:#0d1017;border-right:1px solid rgba(255,255,255,0.06);display:flex;flex-direction:column;overflow:hidden;flex-shrink:0">
        <div style="padding:10px;border-bottom:1px solid rgba(255,255,255,0.06)">
          <div style="position:relative">
            <span style="position:absolute;left:9px;top:50%;transform:translateY(-50%);pointer-events:none;font-size:13px">üîç</span>
            <input id="search-input"
              style="width:100%;background:rgba(255,255,255,0.06);border:1px solid rgba(245,158,11,0.25);border-radius:8px;padding:8px 8px 8px 30px;color:#e2e8f0;font-size:13px;font-family:inherit"
              placeholder="Buscar h√©roe..."
              value="${search}"
              autocomplete="off"
            />
          </div>
          ${search ? `<div style="font-size:11px;color:#4b5563;margin-top:5px;padding-left:2px">${filtered.length} resultado${filtered.length!==1?'s':''}</div>` : ''}
        </div>
        <div style="flex:1;overflow-y:auto">
          ${list.map(h => `
            <button class="hrow" onclick="selectHero(${h.id})"
              style="padding:7px 10px;display:flex;align-items:center;gap:9px;border-left:3px solid ${selected?.id===h.id?'#f59e0b':'transparent'};background:${selected?.id===h.id?'rgba(245,158,11,0.12)':'transparent'}">
              <img src="${HERO_IMG(h.name)}"
                style="width:46px;height:26px;border-radius:4px;object-fit:cover;background:#1a2030;flex-shrink:0"
                onerror="this.style.opacity='0.1'" />
              <div style="flex:1;min-width:0">
                <div style="font-size:12px;color:${selected?.id===h.id?'#f59e0b':'#d1d5db'};font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${h.full}</div>
                <div style="display:flex;gap:4px;margin-top:2px">
                  ${h.roles.slice(0,2).map(r=>`<span style="font-size:9px;color:${ROLES_COLOR[r]||'#555'};font-weight:700">${r}</span>`).join('')}
                </div>
              </div>
            </button>
          `).join('')}
        </div>
      </aside>

      <!-- MAIN -->
      <main style="flex:1;overflow-y:auto;min-width:0">
        ${!selected ? `
          <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:16px;padding:40px;text-align:center">
            <div style="font-size:60px">‚öîÔ∏è</div>
            <div style="font-size:24px;font-weight:900;letter-spacing:2px;color:#fff">Elige un h√©roe</div>
            <div style="font-size:14px;color:#6b7280;max-width:300px;line-height:1.6">Haz clic en cualquier h√©roe de la lista para ver su build con mayor winrate</div>
          </div>
        ` : `
          <!-- BANNER -->
          <div style="position:relative;height:160px;overflow:hidden">
            <div style="position:absolute;inset:0;background-image:url(${HERO_IMG(selected.name)});background-size:cover;background-position:center 25%;filter:blur(4px) brightness(0.3);transform:scale(1.1)"></div>
            <div style="position:absolute;inset:0;background:linear-gradient(to bottom,rgba(0,0,0,0.1),#0a0c10)"></div>
            <div style="position:relative;z-index:1;padding:20px 28px;display:flex;align-items:flex-end;gap:20px;height:100%">
              <img src="${HERO_IMG(selected.name)}" style="width:90px;height:52px;border-radius:6px;object-fit:cover;border:2px solid rgba(245,158,11,0.5)" onerror="this.style.display='none'" />
              <div>
                <h1 style="font-size:30px;font-weight:900;letter-spacing:2px;color:#fff;text-transform:uppercase;text-shadow:0 2px 12px rgba(0,0,0,0.9)">${selected.full}</h1>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px">
                  ${selected.roles.map(r=>`<span style="font-size:10px;border:1px solid ${ROLES_COLOR[r]||'#555'};border-radius:100px;padding:2px 9px;font-weight:700;color:${ROLES_COLOR[r]||'#aaa'}">${r}</span>`).join('')}
                </div>
              </div>
            </div>
          </div>

          <!-- TABS -->
          <div style="display:flex;padding:0 28px;border-bottom:1px solid rgba(255,255,255,0.07)">
            <button class="tab-btn ${tab==='items'?'active':''}" onclick="setTab('items')">üó°Ô∏è Items por fase</button>
            <button class="tab-btn ${tab==='abilities'?'active':''}" onclick="setTab('abilities')">‚ú® Habilidades</button>
          </div>

          <!-- CONTENT -->
          <div style="padding:22px 28px 48px">
            ${loading ? `
              <div style="display:flex;flex-direction:column;align-items:center;gap:14px;padding:60px;color:#6b7280;font-size:14px">
                <div style="width:28px;height:28px;border:2px solid rgba(245,158,11,0.15);border-top:2px solid #f59e0b;border-radius:50%;animation:spin 0.8s linear infinite"></div>
                Cargando builds de ${selected.full}...
              </div>
            ` : error ? `
              <div style="margin:4px 0 20px;padding:16px 20px;background:rgba(248,113,113,0.08);border:1px solid rgba(248,113,113,0.25);border-radius:10px;color:#f87171;font-size:13px">
                ‚ö†Ô∏è ${error}
              </div>
            ` : items ? `

              ${tab === 'items' ? `
                <p style="font-size:13px;color:#4b5563;margin-bottom:16px">Top 6 √≠tems por <strong style="color:#f59e0b">winrate</strong> en cada fase del juego</p>
                ${getPhases(items).map(renderPhase).join('')}
              ` : `
                <p style="font-size:13px;color:#4b5563;margin-bottom:16px">Habilidades con mayor <strong style="color:#f59e0b">winrate</strong></p>
                ${getAbilities(abilities).length === 0
                  ? '<div style="color:#4b5563;padding:20px;text-align:center">Sin datos de habilidades</div>'
                  : getAbilities(abilities).map((ab,i) => renderAbilityRow(ab,i)).join('')
                }
              `}

            ` : ''}
          </div>
        `}
      </main>
    </div>
  </div>`;

  // Bind search
  const inp = document.getElementById('search-input');
  if (inp) {
    inp.addEventListener('input', e => setState({search: e.target.value}));
    inp.focus();
  }
}

function selectHero(id) {
  const hero = HEROES.find(h => h.id === id);
  if (hero) loadHero(hero);
}

function setTab(tab) {
  setState({tab});
}

// Initial render
render();
</script>
</body>
</html>
